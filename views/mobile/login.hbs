{{#extend "mStyle"}}
    <style>
        html {
            height: 100%;
        }

        body {
            font-size: 0.3rem;
            padding: 0;
            margin: 0;
            overflow-x: hidden;
            background-color: #1da1f2;
            height: 100%;
        }

        .wrap {
        }

        .content {
            position: fixed;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            z-index: 10;

        }

        .login {
            margin: 3.5rem 7% 0;
            position: relative;

        }

        .login .br {
            margin-bottom: 0.3rem;
            color: #fff;
            position: relative;
        }

        .login input {
            display: block;
            width: 100%;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            height: 0.4rem;
            line-height: 0.4rem;
            color: #fff;
            padding: 0.5rem 0.2rem;
            box-sizing: border-box;
            -webkit-border-radius: 0.2rem;
            -moz-border-radius: 0.2rem;
            border-radius: 0.2rem;
        }

        .login ::-webkit-input-placeholder {
            color: #fff;
        }

        .login button {
            width: 100%;
            height: 1rem;
            -webkit-border-radius: 0.2rem;
            -moz-border-radius: 0.2rem;
            border-radius: 0.2rem;
            background: rgba(255, 255, 255, 0.01);
            border: none;
            font-size: 0.4rem;
            color: #fff;
            border: 1px solid #fff;
        }

        .login button:focus,
        .login button:hover {
            font-size: 0.4rem;
        }

        .login button:active {
            background: #1d65ab;
            border: none;
            color: #fff;
            font-size: 1.2rem;
            font-size: 0.4rem;
        }

        input:-webkit-autofill {
            background: #1d84ce;
            color: #fff;
        }

        .other-login span {
            color: #fff;
        }

        .other-login {
            position: absolute;
            bottom: 1rem;
            width: 100%;

        }

        .other-login h3 {
            width: 60%;
            margin: 0 auto;
            border-bottom: 1px solid #fff;
            color: #fff;
            height: 0.2rem;
            text-align: center;
        }

        .other-login h3 span {
            background: #1da1f2;

        }

        .list {
            text-align: center;
            padding-top: 0.35rem;
        }

        .list span {
            display: inline-block;
            width: 1rem;
            height: 1rem;

        }

        .wx {
            background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAARVBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////9SnXPCAAAAFnRSTlMACydse10FFNm+81KHlEfnM6Edr8w9ZbTz/wAABllJREFUeNq82dtypCAQBuBGQTkKCP7v/6hblczuzhgcQJ18d0lRoemGBit0zrwJ62JS0vusUnRWBEa/ZBhjxjfts1LS68dP2YmVPmsVUQOQke9WPAdhkwTg4+eCmEcJQPFAR6aNZwB5nOl2zCjA822qDlysBtIy3bt4C8AFarREQHN2X+UdoEzXkpjIAL+nEkMEUqBuSwbs9RCYBeJAp2wKGOmaxUMNdFqQkOFK8RO0oUtGwJ2ugwAsu3yAIvR2rvoRcqAbLBqc+g0Sjt3URRRUdxkMIOg2vLsMvJL+XpuGoQ4OitGtZtnREqaIONHNmIJtH+roflNCbBuowOkjXNvCIjh9SGypgq2EebEKY/38RfoclmFq/UdN9EGzxPa2/0Iy+qhV6/lNjSQG+rAF6d05EfRx9ngjGkT6BQrhoDyQjH7BrH15noRAv8KU+9HS3IHYMMzTtSIMhRPgNasmzzglNb757MRw8ixClVqgqHwcOomf1KkPUQ5RCWpvtThS/xBtSrd714JCxFv9H6Jm3wxmpOPVK1R5Q32knnbtKRx/2zTJgXoIjK8JULXl1/G+XeCnl125HV0dHRLrSoF4CkfnG+YH5NqRAi2f5xGV+Vt1dCb7NDiB3TM/fHtbGmD/b8FIBQH9ei7UrP8ftKW4T3FGmqhqP23W5Rq9cIGtQmMnbfNsJJ6NVLNP/AxbL0B4DH1l/j4ln83ttzJ9MaUKTOVlcTxz/zr7s9hcg8eyXOkMmPLxWgoJIFpL2aobHuvyufg+exGKcYl/f+lFokZafYdvSxsExWQ7PFMH9xWjNgnTV1Pe6lfgI1nbPq6pkADANG+C7WtRhZObsSe5EbHwFDHGYi91bQLl6SecI1W048gttZm+SutV6dnaL/OwCheV1NBSxfr/jx77n5X24Na9dDEb5/e/dLXnatJEodQ7Refil9miSI/s/ZXMyJQOAUcHvwwOx+xMhwQCcaylyNpFVgtX0JENgizYpRKINaMmzW/OoQNd2IQ6mKZhCxWtGCmieFU3GgTaGCqZwSlpOt+INgNciWCCLTdCkmhhDHAtAjjKkgocGvDh8pMd8SCAAXX+T+/mgmwnCAPQgIAiCKiQ/S+1M9RO381FUSo9CxDN35AojU+I5RfQ/iRVV3GSBAQbaQJda+UqLtkImxxx/3QVPdKKzeX7qkslMLTZDUvEqkoF/iTQGL5+O/RScsMFoYipatTjD/xXMe8KH8IKkdCeVXBrxQVSycYHKgF2mRUCShiQQxE24RXbUmgOBKoUtpMq9hOHBhy60856RQMEO+y0hWfpIxStSvlRGD72hAWwhY3GO5ULw4b+lBixAVr85CA0ZcU8dQUZsAVZ+DXaZzgnzFgmOWxBkDi05PJrhHPGiEV4mwQMMbLhcIXri+QSvM0GOKl9+SGHKxiWCIANEDfUWfskId8sUB14fI4n9dAKQIzgbmLOxeRzVlqUkzZlCXb2qITPCcQEtuOI9YYGotuM1fNfYTboQJOM70mjtIg+jv/jltyZwVohAGxzHKStUnOhg+xtOkGBrVkAtFmsUF9pQKdKqmizAPDTj6S0nWpABzglPs4DNAweBBRwQrju8TyAhrv1p/dPXkELEm+jFTUuTe5P+r7BNAI1wfR5hQQ3aDdEzb68K5LnmJ5vsCggCHTFK6S2ub8aQyHA0/PaRQDK4jUWvhBfx7HZM2glrA9/izeMxbGGdrZLKYyVYQ0y1tAGk+tMXW/dMSNvDWtw1P++erDs0f9uWgs3AkDIyXS/N6whukwRuQkR2a2DlEcOHZD+0+QT6vNJMgUdUIP9GQMvpslkr1lC9WHs6Wrk0UBnBAo4h3Ufp3MVX+M4b9CRUL3gTzlz94LPdQkbjAw6MXoMUGXoNlbKJnT37FR3kcE4obzrKbGDHXB/38cl+td9Iczo4DYGZw6v4nAO8ICEKN+Nf54/LjVXBhW6Lpmw5bUtj9S2ZgOG1NONMNu6aAQ8kinBxmWxfey2qNV/WWxcEQfVLH3xwrJY8jgPrHVNM75gx0pOiIK1/KpEB+9gJsQlwX2U23Nv6T1c3rm9Kc9gZ7Il+trWcbSJVbd+px6bxxlufd58TuOJ2p2N+cZ2g7ehu98YV2Fc4BsDYBsPToo19yn8YkboDT/WzAnTbuUG/w3FnZGDsMtixSCNaz76F5Xlf+kzGAt/AAAAAElFTkSuQmCC") center no-repeat;
            background-size: contain;
        }

        * {
            moz-user-select: -moz-none;
            -moz-user-select: none;
            -o-user-select: none;
            -khtml-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .wx:focus,
        .wx:hover {
            opacity: 0.8;
        }

        .f-link {
            position: absolute;
            right: 0;
        }

        .login p {
            padding-top: 0.1rem;
        }

        .circle {
            display: none;
            position: absolute;
            left: 50%;
            top: 0.2rem;
            box-sizing: border-box;
            width: 0.7rem;
            margin-left: -0.35rem;
            height: 0.7rem;
            border-radius: 100%;
            border: 10px solid rgba(255, 255, 255, 0.2);
            border-top-color: #FFF;
            -webkit-animation: spin 1s infinite linear;
            animation: spin 1s infinite linear;
        }

        @-webkit-keyframes spin {
            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

        @keyframes spin {
            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

        input {
            -webkit-user-select: auto !important;
        }

        .back {
            position: fixed;
            left: 0rem;
            top: 0;
            margin: 0.2rem;
            border: none;
            background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACABAMAAAAxEHz4AAAAJFBMVEUAAAD///////////////////////////////////////////+0CY3pAAAAC3RSTlMAPimt6hDIZYpS985VSwcAAAD9SURBVGje7dUtDsJAEIbhAcKfq8fgMfVoFAbBAfCYegxHqK/jBlBCKXM5kk0lhn1JOmzm9W2edr+m4nlfNs6ENWuEtdZCSCPVBgJUCwYIBARQLQkgEAgglDGAtn0BJt3111jA0QFWAEsIuElc4y0E7B3wI8CLAjYSmZU34AAMuEDAfdfTCIcKASsHWAEcIOAhkS0gYOAAK4A6FlB1NzjTJ8gFzrgWwR8S/pI4AS+JTwlvKYEtGCAY2EL+x1swQDAwR99CcoToX+28u8EzmlAlQJhiwikBgoGDMEAwcBBJEOxsoRH4FkphB9GKEEIAAEIAEEIAIEIAEEIhnve5N4voWJhDhz/BAAAAAElFTkSuQmCC");
            width: 0.8rem;
            height: 0.8rem;
            background-size: contain;

        }

        .validate-msg {
            height: 0.6rem;
            line-height: 0.6rem;
            text-align: center;
            padding-top: 0;
            background: rgba(255, 255, 255, 0.2);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 10;
            color: #ff2222;
            display: none;
        }
    </style>
{{/extend}}
<div class="wrap">
    <div class="content">
        <button class="back"></button>
        <div class="login">
            <div class="br">
                <input id="phone" type="tel" placeholder="手机号"/>
            </div>
            <div class="br">
                <input id="password" type="password" placeholder="密码"/>
            </div>
            <div class="br">
                <button id="login">登录</button>
                <div class="circle"></div>
            </div>
            <div class="br rf-btn">
                <span class="r-link">注册</span>
                <span class="f-link">忘记密码</span>
            </div>
        </div>
        <div class="other-login">
            <h3><span>社交账号快速登录</span></h3>

            <div class="list">
                <span class="wx"></span>
            </div>
        </div>
    </div>

</div>
<div class="validate-msg"></div>
{{#extend "mScripts"}}
    <script>
        (function (w) {
            w.validate = {
                phone: function (str) {
                    return /^1[3|4|5|7|8][0-9]\d{8}$/.test($.trim(str));
                },
                realName: function (str) {
                    return /^[\u4e00-\u9fa5]{1,5}$/.test($.trim(str));
                },
                email: function (str) {
                    return /(^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$)/.test($.trim(str));
                },
                fromTime: function (str) {
                    return /^(20)[0,1][0,1,2,3,4,5,6][0-9]{2}\d{2}$/.test($.trim(str));
                },
                singed: function (str) {
                    return /^[\u4e00-\u9fa5]{0,20}/.test($.trim(str));
                },
                city: function (str) {
                    return /^[\u4e00-\u9fa5]{2,10}$/.test($.trim(str));
                },
                title: function (str) {
                    return /^([\u4e00-\u9fa5]|\d){1,10}$/.test($.trim(str))
                },
                description: function (str) {
                    return /^([\u4E00-\u9FA5]|\w|（|）|\(|\)|"|'|\.|。|!|,|，|！|\d|\n|\r|、){1,500}$/.test($.trim(str.replace('', " ")));
                },
                password: function (str) {
                    return /^(\d|[A-Za-z]){6,10}$/.test($.trim(str))
                }

            }

        })(window);
    </script>
    <script>
        $(function () {

            var selfW = '';

            $('#login').tap(function () {
                var that = $('.login');
                postLogin(that, 'l')
            });

            function postLogin(that, s) {
                $('.validate-msg').css('display', 'none');
                var parent = that;
                var phone_val = parent.find('#phone').val();
                var password_val = parent.find('#password').val();
                var pass = true;
                if (!validate.phone(phone_val)) {
                    $('.validate-msg').html('手机格试不正确').css('display', 'block');
                    pass = false;
                }
                if (!validate.password(password_val)) {
                    pass = false;
                    $('.validate-msg').html('密码格式由6到8位字母和数字组成').css('display', 'block');
                }

                if (pass) {
                    $('#login').html('');
                    $('.circle').css('display', 'block');
                    $.post('/login', {phone: phone_val, password: password_val, type: s}, function (data) {
                        console.log(typeof data)
                        if(typeof data=="string"){
                            var data=JSON.parse(data);
                        }
                        $('.circle').css('display', 'none');
                        $('#login').html('登录');
                        if (data.ok == 1) {
                            if (s == "l") {
                                store.set('username', data.sesstion['phone']);
                                if (window.plus) {
                                    var topW = plus.webview.getLaunchWebview();
                                    topW.evalJS('$(".my").trigger("tap")');
                                    selfW.hide('auto');
                                } else {

                                    window.location.href = `http://${window.location.host}/m`;
                                    console.log(window.location.href)
                                }
                            }
                        } else {
                            $('.validate-msg').html(data.msg).css('display', 'block');;
                        }
                    })
                }
            }

        })
    </script>
    <script>
        //用到dcloud--------------------------------------
        var loginW = "";
        var waiting = null;
        if (window.plus) {
            plusReady();
        } else {
            document.addEventListener("plusready", plusReady, false);
        }


        function plusReady() {


            $('.r-link').tap(function () {

                if (loginW) {
                    plus.webview.show(loginW, "slide-in-right");
                } else {
                    waiting = plus.nativeUI.showWaiting();
                    loginW = plus.webview.create("{{static}}m/register", "{{static}}m/register", {
                                zindex: 2,
                                top: '0',
                                bottom: '0',
                                background: '#1da1f2',
                                'popGesture': 'hide'
                            },
                            "slide-in-right");
                    loginW.onloaded = function () {
                        plus.webview.show(loginW, "slide-in-right");
                        waiting && waiting.close();
                        waiting = null;
                    }
                }
            });


            selfW = plus.webview.currentWebview();
            plus.navigator.setStatusBarBackground("#1da1f2");
            selfW.addEventListener("hide", function (e) {
                plus.navigator.setStatusBarBackground("#ffffff");
            }, false);
            selfW.addEventListener("show", function (e) {
                plus.navigator.setStatusBarBackground("#1da1f2");
            }, false);
            $('.back').tap(function () {
                $('input').trigger('blur');
                selfW.hide('auto');
            })
        }


    </script>
{{/extend}}